---
import type { TimelineItem } from '../data/site-config';

export type TimelineBlockProps = TimelineItem;
const {
  period,
  title,
  subtitle,
  location,
  content,
  bullets = [],
  images = [],
  href,
} = Astro.props as TimelineBlockProps;
---

<li class="grid grid-cols-1 gap-4 md:grid-cols-[1fr_minmax(10rem,14rem)]">
  <!-- LEFT: content -->
  <div class="relative pr-8">
    <!-- article content -->
    <article class="group rounded-xl border border-slate-200 bg-white p-4 shadow-sm transition-colors hover:bg-slate-50">
      <header class="mb-2">
        {href ? (
          <a href={href} class="inline-flex items-baseline gap-2">
            <h3 class="text-base font-semibold underline decoration-transparent underline-offset-4 transition-[text-decoration-color] group-hover:decoration-primary">
              {title}
            </h3>
            {location && <span class="text-xs text-slate-500">· {location}</span>}
          </a>
        ) : (
          <div class="inline-flex items-baseline gap-2">
            <h3 class="text-base font-semibold">{title}</h3>
            {location && <span class="text-xs text-slate-500">· {location}</span>}
          </div>
        )}
        {subtitle && <p class="text-sm text-slate-600 mt-0.5">{subtitle}</p>}
      </header>

      {content && <p class="text-sm leading-6 text-slate-700">{content}</p>}

      {bullets.length > 0 && (
        <ul class="mt-2 list-disc pl-4 text-sm text-slate-700">
          {bullets.map((b) => <li>{b}</li>)}
        </ul>
      )}

      {images.length > 0 && (
        <div class="mt-3 grid grid-cols-2 gap-2 sm:grid-cols-3">
          {images.map((img) => (
            <img
              src={img.src}
              alt={img.alt ?? ""}
              loading="lazy"
              class="h-24 w-full rounded-md object-cover"
            />
          ))}
        </div>
      )}
    </article>
  </div>

  <!-- RIGHT: timeline axis + period -->
  <div class="relative md:pl-8">
    <!-- vertical line -->
    <span aria-hidden="true" class="absolute left-0 top-0 bottom-0 flex justify-center">
      <span class="w-px bg-slate-200 block"></span>
    </span>

    <!-- dot -->
    <span aria-hidden="true" class="absolute -left-[5px] mt-1.5 h-2.5 w-2.5 rounded-full bg-primary shadow ring-2 ring-white"></span>

    <div class="ml-4 text-sm font-medium text-slate-900">{period}</div>
  </div>
</li>
